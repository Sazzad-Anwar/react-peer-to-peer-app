(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{137:function(e,t){},139:function(e,t){},156:function(e,t,n){},157:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(9),r=n.n(c),i=n(22),l=n(197),o=n(192),s=n(187),d=n(190),u=n(158),j=n(19),b=n(87),m=n(50),x=n.n(m),p=n(4),O=Object(a.createContext)(),f=Object(b.io)("http://localhost:5000"),h=function(e){var t=e.children,n=Object(a.useState)(null),c=Object(j.a)(n,2),r=c[0],i=c[1],l=Object(a.useState)(""),o=Object(j.a)(l,2),s=o[0],d=o[1],u=Object(a.useState)({}),b=Object(j.a)(u,2),m=b[0],h=b[1],g=Object(a.useState)(!1),v=Object(j.a)(g,2),C=v[0],y=v[1],w=Object(a.useState)(!1),N=Object(j.a)(w,2),k=N[0],S=N[1],I=Object(a.useState)(""),D=Object(j.a)(I,2),A=D[0],B=D[1],R=Object(a.useRef)(),V=Object(a.useRef)(),E=Object(a.useRef)();Object(a.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){i(e),console.log(e),R.current.srcObject=e})).catch((function(e){return console.log(e)})),f.on("me",(function(e){return d(e)})),f.on("calluser",(function(e){var t=e.from,n=e.name,a=e.signal;h({isReceivingCall:!0,from:t,name:n,signal:a})}))}),[]);return Object(p.jsx)(O.Provider,{value:{call:m,callAccepted:C,myVideo:R,userVideo:V,stream:r,name:A,setName:B,callEnded:k,me:s,callUser:function(e){var t=new x.a({initiator:!0,trickle:!1,stream:r,config:{iceServers:[{urls:["stun:stun.royex.io"]},{urls:["turn:turn.royex.io:3478?transport=udp","turn:turn.royex.io:5349?transport=tcp"],username:"royex",credential:"12345"}]}});t.on("signal",(function(t){f.emit("calluser",{userToCall:e,signalData:t,from:s,name:A})})),t.on("stream",(function(e){V.current.srcObject=e})),f.on("callaccepted",(function(e){y(!0),t.signal(e)}))},leaveCall:function(){S(!0),console.log(E),x.a.disconnect()},answerCall:function(){y(!0);var e=new x.a({initiator:!1,trickle:!1,stream:r,iceServers:[{urls:["stun:stun.royex.io"]},{urls:["turn:turn.royex.io:3478?transport=udp","turn:turn.royex.io:5349?transport=tcp"],username:"royex",credential:"12345"}]});e.on("signal",(function(e){f.emit("answercall",{signal:e,to:m.from})})),e.on("stream",(function(e){V.current.srcObject=e})),e.signal(m.signal),E.current=e}},children:t})},g=Object(s.a)((function(e){return{video:Object(i.a)({width:"550px"},e.breakpoints.down("xs"),{width:"300px"}),gridContainer:Object(i.a)({justifyContent:"center"},e.breakpoints.down("xs"),{flexDirection:"column"}),paper:{padding:"10px",border:"2px solid black",margin:"10px"}}})),v=function(){var e=Object(a.useContext)(O),t=e.name,n=e.callAccepted,c=e.myVideo,r=e.userVideo,i=e.callEnded,l=e.stream,s=e.call,j=g();return Object(p.jsxs)(d.a,{container:!0,className:j.gridContainer,children:[l&&Object(p.jsx)(u.a,{className:j.paper,children:Object(p.jsxs)(d.a,{item:!0,xs:12,md:6,children:[Object(p.jsx)(o.a,{variant:"h5",gutterBottom:!0,children:t||"Name"}),Object(p.jsx)("video",{playsInline:!0,muted:!0,ref:c,autoPlay:!0,className:j.video})]})}),n&&!i&&Object(p.jsx)(u.a,{className:j.paper,children:Object(p.jsxs)(d.a,{item:!0,xs:12,md:6,children:[Object(p.jsx)(o.a,{variant:"h5",gutterBottom:!0,children:s.name||"Name"}),Object(p.jsx)("video",{playsInline:!0,muted:!0,ref:r,autoPlay:!0,className:j.video})]})})]})},C=n(199),y=function(){var e=Object(a.useContext)(O),t=e.answerCall,n=e.call,c=e.callAccepted;return Object(p.jsx)(p.Fragment,{children:n.isReceivingCall&&!c&&Object(p.jsxs)("div",{style:{display:"flex",justifyContent:"center"},children:[Object(p.jsxs)("h1",{children:[n.name," is calling"]}),Object(p.jsx)(C.a,{variant:"contained",color:"primary",onClick:t,children:"Answer"})]})})},w=n(193),N=n(198),k=n(93),S=n(194),I=n(195),D=n(196),A=Object(s.a)((function(e){return{root:{display:"flex",flexDirection:"column"},gridContainer:Object(i.a)({width:"100%"},e.breakpoints.down("xs"),{flexDirection:"column"}),container:Object(i.a)({width:"600px",margin:"35px 0",padding:0},e.breakpoints.down("xs"),{width:"80%"}),margin:{marginTop:20},padding:{padding:20},paper:{padding:"10px 20px",border:"2px solid black"}}})),B=function(e){var t=e.children,n=Object(a.useContext)(O),c=n.me,r=n.callAccepted,i=n.name,l=n.setName,s=n.leaveCall,b=n.callUser,m=n.callEnded,x=Object(a.useState)(""),f=Object(j.a)(x,2),h=f[0],g=f[1],v=A();return Object(p.jsx)(w.a,{className:v.container,children:Object(p.jsxs)(u.a,{elevation:10,className:v.paper,children:[Object(p.jsx)("form",{className:v.root,noValidate:!0,autoComplete:"off",children:Object(p.jsxs)(d.a,{container:!0,className:v.gridContainer,children:[Object(p.jsxs)(d.a,{item:!0,xs:12,md:6,className:v.padding,children:[Object(p.jsx)(o.a,{gutterBottom:!0,variant:"h6",children:"Account info"}),Object(p.jsx)(N.a,{label:"Name",vlaue:i,onChange:function(e){return l(e.target.value)},fullWidth:!0}),Object(p.jsx)(k.CopyToClipboard,{text:c,className:v.margin,children:Object(p.jsx)(C.a,{variant:"contained",color:"primary",fullWidth:!0,startIcon:Object(p.jsx)(S.a,{fontSize:"large"}),children:"Copy Your ID"})})]}),Object(p.jsxs)(d.a,{item:!0,xs:12,md:6,className:v.padding,children:[Object(p.jsx)(o.a,{gutterBottom:!0,variant:"h6",children:"Account info"}),Object(p.jsx)(N.a,{label:"ID to Call",vlaue:h,onChange:function(e){return g(e.target.value)},fullWidth:!0}),r&&!m?Object(p.jsx)(C.a,{variant:"contained",color:"secondary",startIcon:Object(p.jsx)(I.a,{fontSize:"large"}),onClick:s,fullWidth:!0,className:v.margin,children:"Hang Up"}):Object(p.jsx)(C.a,{variant:"contained",color:"primary",startIcon:Object(p.jsx)(D.a,{fontSize:"large"}),onClick:function(){return b(h)},fullWidth:!0,className:v.margin,children:"Call"})]})]})}),t]})})},R=Object(s.a)((function(e){return{appBar:Object(i.a)({borderRadius:15,margin:"30px 100px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",width:"600px",border:"2px solid black"},e.breakpoints.down("xs"),{width:"90%"}),image:{marginLeft:"15px"},wrapper:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"}}})),V=function(){var e=R();return Object(p.jsxs)("div",{className:e.wrapper,children:[Object(p.jsx)(l.a,{className:e.appBar,position:"static",color:"inherit",children:Object(p.jsx)(o.a,{variant:"h3",align:"center",children:"Video Chat"})}),Object(p.jsx)(v,{}),Object(p.jsx)(B,{children:Object(p.jsx)(y,{})})]})};n(156);r.a.render(Object(p.jsx)(h,{children:Object(p.jsx)(V,{})}),document.getElementById("root"))}},[[157,1,2]]]);
//# sourceMappingURL=main.16556f90.chunk.js.map